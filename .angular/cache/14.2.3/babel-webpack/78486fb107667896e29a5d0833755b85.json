{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { routes } from 'src/app/consts/routes';\nlet DetailsComponent = class DetailsComponent {\n  constructor(router1, matExpansionModule, matTableModule, router, fb, auth, toastrService, tokenStorage) {\n    this.router1 = router1;\n    this.matExpansionModule = matExpansionModule;\n    this.matTableModule = matTableModule;\n    this.router = router;\n    this.fb = fb;\n    this.auth = auth;\n    this.toastrService = toastrService;\n    this.tokenStorage = tokenStorage;\n    this.data = [];\n    this.panelOpenState = false;\n    this.routers = routes;\n    this.back1 = [];\n    this.relationshipMap = new Map();\n    this.nomineeRelationshipMap = new Map();\n    this.premium = new premiumDetail();\n    this.otpverify = new otpsend();\n    this.otpvalidated = true;\n    this.databstoggle = false;\n  }\n\n  back() {\n    this.router1.navigate([this.routers.CDOT]).then();\n  } // 1661742887552\n\n\n  getpremiumdetails() {\n    console.log(\"Premium for proposal ID:\" + this.proposalid);\n    this.auth.get('getPremiumDetails/' + this.proposalid).subscribe(resp => {\n      console.log(\"premium\", resp); // if(resp == null){\n      //   this.premium.netpremium=0\n      //   this.premium\n      // }\n      // else{\n\n      this.premium = resp; // }\n\n      console.log(\"Premium Details:\" + JSON.stringify(this.premium));\n    });\n  }\n\n  getdetails() {\n    // this.auth.get('getcoireq').subscribe((resp)=>{this.toldata=resp;\n    //   this.data2 = JSON.stringify(this.toldata);\n    //   console.log(\"coidataa.\"+this.data2)\n    //   if(this.data2.proposalid==this.data.proposalid)\n    //   {\n    //     return this.data2= this.toldata;\n    //   }\n    // })\n    this.data = this.tokenStorage.get(\"coidata\");\n    this.proposalid = this.tokenStorage.get(\"proposalid\");\n  }\n\n  ngOnInit() {\n    // this.getdetails();\n    this.data = JSON.parse(this.tokenStorage.get(\"coidata\"));\n    this.data2 = this.data;\n    console.log(\"Proposal Data:\" + this.data);\n    console.log(\"no of insured:\" + this.data.occupation);\n    this.proposalid = this.tokenStorage.get(\"proposalid\");\n    this.getpremiumdetails(); // this.data=JSON.parse(localStorage.getItem(\"savedata\"));\n    //  this.back1=JSON.parse(sessionStorage.getItem(\"backdata\"))\n    //  console.log(\"details back\"+JSON.stringify(this.back1))\n    //  this.relationshipMap.set(\"R001\",\"Self\");\n    //  this.relationshipMap.set(\"R002\",\"Spouse\");\n    //  this.relationshipMap.set(\"R003\",\"Dependent Son\");\n    //  this.relationshipMap.set(\"R004\",\"Dependent Daughter\");\n    //  this.relationshipMap.set(\"R005\",\"Mother\");\n    //  this.relationshipMap.set(\"R006\",\"Father\");\n\n    this.getNomRelation();\n    this.getRelationship();\n  }\n\n  getNomRelation() {\n    this.auth.get(\"nomrelation\").subscribe(data => {\n      //console.log(\"nomrelation--\" + JSON.stringify(data));\n      let nmr = [];\n      nmr = data;\n\n      for (let index = 0; index <= nmr.length - 1; index++) {\n        this.nomineeRelationshipMap.set(nmr[index].nominee_rcode, nmr[index].nominee_rname);\n      }\n    });\n  }\n\n  getRelationship() {\n    this.auth.get(\"getrelationship\").subscribe(data => {\n      //console.log(\"nomrelation--\" + JSON.stringify(data));\n      let nmr = [];\n      nmr = data;\n\n      for (let index = 0; index <= nmr.length - 1; index++) {\n        this.relationshipMap.set(nmr[index].rcode, nmr[index].rname);\n      }\n    });\n  }\n\n  adddate() {}\n\n  verify() {\n    this.otpverify.proposalId = this.proposalid;\n    this.otpverify.otpfetch = this.otp;\n\n    if (this.otp != \"\" && this.otp != null) {\n      // alert(this.proposalid)\n      this.auth.post(\"payment/verifyotp\" + this.otpverify, \"\").subscribe(data => {\n        if (data && data == 100) {\n          this.paypage();\n        } else {\n          this.toastrService.error(\"issue in payment process..\");\n        }\n      });\n    }\n  }\n\n  payment() {\n    this.auth.post('payment/otpsend/' + this.proposalid, \"\").subscribe(data => {\n      console.log(\"data\", data);\n\n      if (data == 100) {\n        // this.toastrService.success(\"OTP Send Successfully...\")\n        this.databstoggle = true;\n      } else {\n        this.toastrService.error(\"Failed OTP Send..\");\n      }\n    }); //   this.auth.post('getpg/'+this.proposalid,\"\").subscribe((data)=>{\n    //     let resp:any=data;\n    //     if(this.otpvalidated){\n    //       let f=document.createElement(\"form\");\n    //       f.setAttribute(\"method\",\"POST\");\n    //       if(resp.insurer=='ABHI'){\n    //         f.setAttribute(\"action\",resp.pgUrl);\n    //       let i =document.createElement(\"input\");\n    //       i.type=\"hidden\";\n    //       i.name=\"SourceCode\";\n    //       i.value=resp.source;\n    //       f.appendChild(i);\n    //        i =document.createElement(\"input\");\n    //       i.type=\"hidden\";\n    //       i.name=\"PhoneNo\";\n    //       i.value=resp.phoneNo;\n    //       f.appendChild(i);\n    //        i =document.createElement(\"input\");\n    //       i.type=\"hidden\";\n    //       i.name=\"Email\";\n    //       i.value=resp.email;\n    //       f.appendChild(i);\n    //        i =document.createElement(\"input\");\n    //       i.type=\"hidden\";\n    //       i.name=\"OrderAmount\";\n    //       i.value=resp.amount;\n    //       f.appendChild(i);\n    //       i =document.createElement(\"input\");\n    //       i.type=\"hidden\";\n    //       i.name=\"Currency\";\n    //       i.value=\"INR\";\n    //       f.appendChild(i);\n    //       i =document.createElement(\"input\");\n    //       i.type=\"hidden\";\n    //       i.name=\"secSignature\";\n    //       i.value=resp.signature;\n    //       f.appendChild(i);\n    //       i =document.createElement(\"input\");\n    //       i.type=\"hidden\";\n    //       i.name=\"ReturnURL\";\n    //       i.value=resp.returnUrl;\n    //       f.appendChild(i);\n    //       i =document.createElement(\"input\");\n    //       i.type=\"hidden\";\n    //       i.name=\"QuoteId\";\n    //       i.value=resp.quote;\n    //       f.appendChild(i);\n    //       i =document.createElement(\"input\");\n    //       i.type=\"hidden\";\n    //       i.name=\"SubCode\";\n    //       i.value=\" \";\n    //       f.appendChild(i);\n    //       i =document.createElement(\"input\");\n    //       i.type=\"hidden\";\n    //       i.name=\"GrossPremium\";\n    //       i.value=resp.amount;\n    //       f.appendChild(i);\n    //       i =document.createElement(\"input\");\n    //       i.type=\"hidden\";\n    //       i.name=\"FinalPremium\";\n    //       i.value=resp.amount;\n    //       f.appendChild(i);\n    //       i =document.createElement(\"input\");\n    //       i.type=\"hidden\";\n    //       i.name=\"SourceTxnId\";\n    //       i.value=this.proposalid;\n    //       f.appendChild(i);\n    //       i =document.createElement(\"input\");\n    //       i.type=\"hidden\";\n    //       i.name=\"productinfo\";\n    //       i.value=resp.productInfo;\n    //       f.appendChild(i);\n    //     }else if(resp.insurer==\"SBIH\"){\n    //       f.setAttribute(\"action\",resp.pgUrl+this.proposalid);\n    //     }\n    //     document.body.appendChild(f);\n    //     f.submit();\n    // }\n    //     });\n    // this.auth.get('payment/'+this.proposalid).subscribe((data)=>{\n    //   console.log(\"payment confirmation:\"+JSON.stringify(data))\n    //   if (data && data.errorCode == 100) {\n    //     this.router1.navigate([this.routers.PAYMENT]).then();\n    //   }\n    //   });\n  }\n\n  paypage() {\n    this.auth.post('getpg/' + this.proposalid, \"\").subscribe(data => {\n      let resp = data;\n\n      if (this.otpvalidated) {\n        let f = document.createElement(\"form\");\n        f.setAttribute(\"method\", \"POST\");\n\n        if (resp.insurer == 'ABHI') {\n          f.setAttribute(\"action\", resp.pgUrl);\n          let i = document.createElement(\"input\");\n          i.type = \"hidden\";\n          i.name = \"SourceCode\";\n          i.value = resp.source;\n          f.appendChild(i);\n          i = document.createElement(\"input\");\n          i.type = \"hidden\";\n          i.name = \"PhoneNo\";\n          i.value = resp.phoneNo;\n          f.appendChild(i);\n          i = document.createElement(\"input\");\n          i.type = \"hidden\";\n          i.name = \"Email\";\n          i.value = resp.email;\n          f.appendChild(i);\n          i = document.createElement(\"input\");\n          i.type = \"hidden\";\n          i.name = \"OrderAmount\";\n          i.value = resp.amount;\n          f.appendChild(i);\n          i = document.createElement(\"input\");\n          i.type = \"hidden\";\n          i.name = \"Currency\";\n          i.value = \"INR\";\n          f.appendChild(i);\n          i = document.createElement(\"input\");\n          i.type = \"hidden\";\n          i.name = \"secSignature\";\n          i.value = resp.signature;\n          f.appendChild(i);\n          i = document.createElement(\"input\");\n          i.type = \"hidden\";\n          i.name = \"ReturnURL\";\n          i.value = resp.returnUrl;\n          f.appendChild(i);\n          i = document.createElement(\"input\");\n          i.type = \"hidden\";\n          i.name = \"QuoteId\";\n          i.value = resp.quote;\n          f.appendChild(i);\n          i = document.createElement(\"input\");\n          i.type = \"hidden\";\n          i.name = \"SubCode\";\n          i.value = \" \";\n          f.appendChild(i);\n          i = document.createElement(\"input\");\n          i.type = \"hidden\";\n          i.name = \"GrossPremium\";\n          i.value = resp.amount;\n          f.appendChild(i);\n          i = document.createElement(\"input\");\n          i.type = \"hidden\";\n          i.name = \"FinalPremium\";\n          i.value = resp.amount;\n          f.appendChild(i);\n          i = document.createElement(\"input\");\n          i.type = \"hidden\";\n          i.name = \"SourceTxnId\";\n          i.value = this.proposalid;\n          f.appendChild(i);\n          i = document.createElement(\"input\");\n          i.type = \"hidden\";\n          i.name = \"productinfo\";\n          i.value = resp.productInfo;\n          f.appendChild(i);\n        } else if (resp.insurer == \"SBIH\") {\n          f.setAttribute(\"action\", resp.pgUrl + this.proposalid);\n        }\n\n        document.body.appendChild(f);\n        f.submit();\n      }\n    });\n  }\n\n};\nDetailsComponent = __decorate([Component({\n  selector: 'app-details',\n  templateUrl: './details.component.html',\n  styleUrls: ['./details.component.css']\n})], DetailsComponent);\nexport { DetailsComponent };\nexport class relationships {}\nexport class nomineerelationships {}\nexport class premiumDetail {}\nexport class otpsend {}","map":null,"metadata":{},"sourceType":"module"}